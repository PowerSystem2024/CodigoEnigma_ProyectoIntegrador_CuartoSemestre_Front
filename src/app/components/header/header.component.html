<div class="left">
  <a href="/" class="logo-container">
    <img src="assets/images/logo.png" alt="logo" class="logo" />
    <span class="title">Mi App</span>
  </a>
</div>

<div class="center">
  <nb-actions size="medium">
    <nb-action><a href="/">Home</a></nb-action>
    <nb-action><a href="/products">Catálogo</a></nb-action>
    <nb-action><a href="/my-order">Mis Pedidos</a></nb-action>
  </nb-actions>
</div>

<div class="right">
  <nb-actions size="medium" class="actions-right">
    <!-- Buscador + Filtros (todo en el ícono de búsqueda) -->
  <nb-action icon="search-outline" [nbPopover]="filtersTpl" nbPopoverPlacement="bottom" #filtersPopover="nbPopover">
    </nb-action>
    <ng-template #filtersTpl>
      <nb-card class="filters-popover" style="min-width: 280px">
        <nb-card-header>Filtros</nb-card-header>
        <nb-card-body>
          <div class="filter-item" style="margin-bottom:8px;">
            <input nbInput fullWidth placeholder="Buscar" [(ngModel)]="searchQuery" />
          </div>
          <div class="filter-item" style="display:flex; gap:8px; margin-bottom:8px;">
            <input nbInput style="flex:1;" type="number" placeholder="Precio mín" [(ngModel)]="minPrice" />
            <input nbInput style="flex:1;" type="number" placeholder="Precio máx" [(ngModel)]="maxPrice" />
          </div>
          <div class="filter-item" style="margin-bottom:8px; display:flex; gap:6px; align-items:center; flex-wrap:wrap;">
            <span style="min-width:60px;">Tamaño:</span>
            <button nbButton size="tiny" [status]="selectedSizes.length === 0 ? 'primary' : 'basic'" (click)="$event.stopPropagation(); clearSizes()">Todos</button>
            <button nbButton size="tiny" [status]="isSizeSelected('Chica') ? 'primary' : 'basic'" (click)="$event.stopPropagation(); toggleSize('Chica')">Chica</button>
            <button nbButton size="tiny" [status]="isSizeSelected('Mediana') ? 'primary' : 'basic'" (click)="$event.stopPropagation(); toggleSize('Mediana')">Mediana</button>
            <button nbButton size="tiny" [status]="isSizeSelected('Grande') ? 'primary' : 'basic'" (click)="$event.stopPropagation(); toggleSize('Grande')">Grande</button>
          </div>
        </nb-card-body>
        <nb-card-footer style="display:flex; gap:8px; justify-content:flex-end;">
          <button nbButton status="basic" size="small" (click)="clearHeaderFilters()">Limpiar</button>
          <button nbButton status="primary" size="small" (click)="applyFiltersFromHeader(); filtersPopover.hide()">Aplicar</button>
        </nb-card-footer>
      </nb-card>
    </ng-template>

  <!-- Carrito -->
    <nb-action icon="shopping-cart-outline"
               [nbPopover]="cart"
               nbPopoverPlacement="bottom"
               badgeText="12"
               badgePosition="bottom right"
               badgeStatus="info"
               title="Carrito">
    </nb-action>
    <ng-template #cart>
      <app-cart></app-cart>
    </ng-template>

    <!-- Menu de Usuario -->
    <nb-action icon="person-outline" [nbPopover]="userMenuTemplate" nbPopoverPlacement="bottom" title="User"></nb-action>
      <!-- Menú para usuario logueado -->
      <ng-template #userMenuTemplate>
        <div *ngIf="isLoggedIn" class="custom-user-menu">
          <!-- <div class="menu-item" (click)="openProfile()">
            <nb-icon icon="person-outline"></nb-icon>
            <span>Perfil</span>
          </div> -->
      
          <div class="menu-item" (click)="goToOrders()">
            <nb-icon icon="shopping-bag-outline"></nb-icon>
            <span>Mis Pedidos</span>
          </div>
      
          <div class="menu-divider"></div>
      
          <div class="menu-item logout-item" (click)="openLogoutDialog()">
            <nb-icon icon="log-out-outline"></nb-icon>
            <span>Cerrar Sesión</span>
          </div>
        </div>
        <div *ngIf="!isLoggedIn" class="custom-user-menu">
          <div class="menu-item logout-item" (click)="openLoginDialog()">
            <nb-icon icon="log-out-outline"></nb-icon>
            <span>Iniciar Sesión</span>
          </div>
        </div>
      </ng-template>
    </nb-actions>
</div>


<div class="left">
  <a href="/" class="logo-container">
    <img src="assets/images/logo.png" alt="logo" class="logo" />
    <span class="title">Mi App</span>
  </a>
</div>

<div class="center">
  <nb-actions size="medium">
    <nb-action><a href="/">Home</a></nb-action>
    <nb-action><a href="/products">Catálogo</a></nb-action>
    <nb-action><a href="/my-order">Mis Pedidos</a></nb-action>
  </nb-actions>
</div>

<div class="right">
  <nb-actions size="medium" class="actions-right">
    <!-- Buscador -->
    <nb-action>
      <nb-search type="column-curtain" placeholder="Buscar..." class="search"></nb-search>
    </nb-action>

    <!-- Botón: Registro (SOLO para usuarios NO logueados) -->
    <nb-action *ngIf="!isLoggedIn">
      <button nbButton ghost size="small"
              (click)="openRegisterDialog()"
              title="Crear una nueva cuenta"
              aria-label="Crear una nueva cuenta">
        <nb-icon icon="person-add-outline"></nb-icon>
        <span class="button-text">Registrarse</span>
      </button>
    </nb-action>

    <!-- Botón: Login (SOLO para usuarios NO logueados) -->
    <nb-action *ngIf="!isLoggedIn">
      <button nbButton ghost size="small"
              (click)="openLoginDialog()"
              title="Iniciar sesión"
              aria-label="Iniciar sesión">
        <nb-icon icon="log-in-outline"></nb-icon>
        <span class="button-text">Iniciar Sesión</span>
      </button>
    </nb-action>

    <!-- Usuario logueado (SOLO cuando isLoggedIn = true) -->
    <nb-action *ngIf="isLoggedIn">
      <button nbButton
              ghost
              size="small"
              [nbPopover]="userMenuTemplate"
              nbPopoverPlacement="bottom"
              title="Mi cuenta"
              aria-label="Menú de usuario">
        <nb-icon icon="person-outline" aria-hidden="true"></nb-icon>
        <span class="button-text">{{ currentUser?.name || 'Usuario' }}</span>
      </button>
    </nb-action>

    <!-- Carrito -->
    <nb-action icon="shopping-cart-outline"
               [nbPopover]="cart"
               nbPopoverPlacement="bottom"
               badgeText="12"
               badgePosition="bottom right"
               badgeStatus="info"
               title="Carrito">
    </nb-action>

    <ng-template #cart>
      <app-cart></app-cart>
    </ng-template>
  </nb-actions>
</div>

<!-- Menú para usuario logueado -->
<ng-template #userMenuTemplate>
  <div class="custom-user-menu">
    <div class="menu-item" (click)="openProfile()">
      <nb-icon icon="person-outline"></nb-icon>
      <span>Perfil</span>
    </div>

    <div class="menu-item" (click)="openOrders()">
      <nb-icon icon="shopping-bag-outline"></nb-icon>
      <span>Mis Pedidos</span>
    </div>

    <div class="menu-item" (click)="openSettings()">
      <nb-icon icon="settings-2-outline"></nb-icon>
      <span>Ajustes</span>
    </div>

    <div class="menu-divider"></div>

    <div class="menu-item logout-item" (click)="openLogoutDialog()">
      <nb-icon icon="log-out-outline"></nb-icon>
      <span>Cerrar Sesión</span>
    </div>
  </div>
</ng-template>
